<!DOCTYPE html>
<html lang='en'>

<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <meta name='viewport' content='width=device-width, initial-scale=1'>

  <title>Powershell</title>
  <meta name='description' content="Alles über IT.">
  <link rel='canonical' href="http://fachinformatiker-fulda.de/LF7_Powershell.html">
  <link rel='alternate' type='application/rss+xml' title='Fachinformatiker-Forum Fulda' href="http://fachinformatiker-fulda.de/feed.xml">

  <style>
    

    html{box-sizing:border-box}*,*:before,*:after{box-sizing:inherit}/*! normalize.css v5.0.0 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:0.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace, monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace, monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,html [type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid #c0c0c0;margin:0 2px;padding:0.35em 0.625em 0.75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-cancel-button,[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}template{display:none}[hidden]{display:none}body,h1,h2,h3,h4,h5,h6,blockquote,p,pre,dl,dd,ol,ul,figure,hr,fieldset,legend{margin:0;padding:0}li>ol,li>ul{margin-bottom:0}table{border-collapse:collapse;border-spacing:0}address,h1,h2,h3,h4,h5,h6,blockquote,p,pre,dl,ol,ul,figure,hr,table,fieldset{margin-bottom:16px}dd,ol,ul{margin-left:16px}@-webkit-keyframes spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.icon{position:relative;display:inline-block;width:25px;height:25px;overflow:hidden;fill:currentColor}.icon__cnt{width:100%;height:100%;background:inherit;fill:inherit;pointer-events:none;transform:translateX(0);-ms-transform:translate(0.5px, -0.3px)}.icon--m{width:50px;height:50px}.icon--l{width:100px;height:100px}.icon--xl{width:150px;height:150px}.icon--xxl{width:200px;height:200px}.icon__spinner{position:absolute;top:0;left:0;width:100%;height:100%}.icon--ei-spinner .icon__spinner,.icon--ei-spinner-2 .icon__spinner{-webkit-animation:spin 1s steps(12) infinite;animation:spin 1s steps(12) infinite}.icon--ei-spinner-3 .icon__spinner{-webkit-animation:spin 1.5s linear infinite;animation:spin 1.5s linear infinite}.icon--ei-sc-facebook{fill:#3b5998}.icon--ei-sc-github{fill:#333}.icon--ei-sc-google-plus{fill:#dd4b39}.icon--ei-sc-instagram{fill:#3f729b}.icon--ei-sc-linkedin{fill:#0976b4}.icon--ei-sc-odnoklassniki{fill:#ed812b}.icon--ei-sc-skype{fill:#00aff0}.icon--ei-sc-soundcloud{fill:#f80}.icon--ei-sc-tumblr{fill:#35465c}.icon--ei-sc-twitter{fill:#55acee}.icon--ei-sc-vimeo{fill:#1ab7ea}.icon--ei-sc-vk{fill:#45668e}.icon--ei-sc-youtube{fill:#e52d27}.icon--ei-sc-pinterest{fill:#bd081c}.icon--ei-sc-telegram{fill:#0088cc}.highlight{margin:0;background:#fff}.highlighter-rouge .highlight{background:#FAFAFA}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{font-weight:bold}.highlight .o{font-weight:bold}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:bold}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:bold;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#aaa}.highlight .gt{color:#a00}.highlight .kc{font-weight:bold}.highlight .kd{font-weight:bold}.highlight .kp{font-weight:bold}.highlight .kr{font-weight:bold}.highlight .kt{color:#458;font-weight:bold}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:teal}.highlight .nb{color:#0086B3}.highlight .nc{color:#458;font-weight:bold}.highlight .no{color:teal}.highlight .ni{color:purple}.highlight .ne{color:#900;font-weight:bold}.highlight .nf{color:#900;font-weight:bold}.highlight .nn{color:#555}.highlight .nt{color:navy}.highlight .nv{color:teal}.highlight .ow{font-weight:bold}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#d14}.highlight .sc{color:#d14}.highlight .sd{color:#d14}.highlight .s2{color:#d14}.highlight .se{color:#d14}.highlight .sh{color:#d14}.highlight .si{color:#d14}.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:teal}.highlight .vg{color:teal}.highlight .vi{color:teal}.highlight .il{color:#099}body{color:#323232;font-size:16px;font-family:"Libre Baskerville",serif;font-weight:300;line-height:32px;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*::selection{color:#fff;background:#207CDF}@font-face{font-family:'Muli';font-style:normal;font-weight:400;src:local("Muli"),url(https://fonts.gstatic.com/s/muli/v9/zscZFkjVRGyfQ_Pw-5exXPesZW2xOQ-xsNqO47m55DA.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:'Libre Baskerville';font-style:normal;font-weight:400;src:local("Libre Baskerville"),local("LibreBaskerville-Regular"),url(https://fonts.gstatic.com/s/librebaskerville/v4/pR0sBQVcY0JZc_ciXjFsK56jerHLVJWaC-9Ja-RK4Ug.woff2) format("woff2");unicode-range:U+0100-024F,U+1E00-1EFF,U+20A0-20AB,U+20AD-20CF,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Libre Baskerville';font-style:normal;font-weight:400;src:local("Libre Baskerville"),local("LibreBaskerville-Regular"),url(https://fonts.gstatic.com/s/librebaskerville/v4/pR0sBQVcY0JZc_ciXjFsK8j0T1k_tV7QYhgnOhA2764.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}a{color:#323232;text-decoration:none;transition:.4s}a:hover,a:active,a:focus{text-decoration:underline}img{display:block;max-width:100%;font-style:italic}hr{height:1px;margin:32px 0;border:0;background-color:#E1E0E1}h1,h2,h3,h4,h5,h6{font-weight:inherit;line-height:initial}h1{font-size:36px}h2{font-size:28px}h3{font-size:24px}h4{font-size:20px}h5{font-size:18px}h6{font-size:16px}b,strong{font-weight:700}blockquote{padding-left:16px;border-left:3px solid #323232;font-style:italic}pre,code{font-family:Courier,monospace;background-color:#ECF0F1}pre{overflow:auto;padding:32px;font-size:16px;line-height:25px;white-space:pre-wrap;word-wrap:break-word;word-break:break-all}p code{padding:3px 6px}input[type='text'],input[type='tel'],input[type='number'],input[type='email'],select,textarea{width:100%;padding:16px;border:1px solid #E1E0E1;border-radius:0;outline:none;background-color:#fff;font-size:14px;font-family:Muli,sans-serif;appearance:none;transition:.4s}input[type='text']:hover,input[type='text']:active,input[type='text']:focus,input[type='tel']:hover,input[type='tel']:active,input[type='tel']:focus,input[type='number']:hover,input[type='number']:active,input[type='number']:focus,input[type='email']:hover,input[type='email']:active,input[type='email']:focus,select:hover,select:active,select:focus,textarea:hover,textarea:active,textarea:focus{border:1px solid #323232}.o-grid{display:flex;flex-wrap:wrap;margin:0 auto;max-width:1200px}.o-grid:after{content:'';display:table;clear:both}.o-grid .o-grid{margin-right:-16px;margin-left:-16px;padding:0}.o-grid--full{max-width:100vw}.o-grid__col{padding-right:16px;padding-left:16px}.o-grid__col--1-4-s{width:25%}.o-grid__col--1-3-s{width:33.3333333333%}.o-grid__col--2-4-s{width:50%}.o-grid__col--3-4-s{width:75%}.o-grid__col--4-4-s{width:100%}@media (min-width: 40em){.o-grid__col--1-4-m{width:25%}.o-grid__col--1-3-m{width:33.3333333333%}.o-grid__col--2-4-m{width:50%}.o-grid__col--3-4-m{width:75%}}@media (min-width: 64em){.o-grid__col--1-4-l{width:25%}.o-grid__col--1-3-l{width:33.3333333333%}.o-grid__col--2-4-l{width:50%}.o-grid__col--3-4-l{width:75%}}.o-grid__col--full{width:100%}.o-grid__col--center{margin:0 auto}.o-grid__col--end{margin-left:auto}.o-wrapper{padding:32px 0}.c-off-canvas-container{display:flex;min-height:100vh;flex-direction:column}.c-off-canvas-container .o-wrapper{flex:1 0 auto}.o-plain-list{margin:0;padding:0;list-style:none}.c-header__inner{padding:16px 0;border-bottom:1px solid #E1E0E1}.c-header__icon{vertical-align:middle}.c-logo__link{font-size:19px;transition:.4s}.c-logo__link:hover,.c-logo__link:active,.c-logo__link:focus{color:#207CDF;text-decoration:none}.c-logo__img{margin:0 auto;max-height:32px}.c-nav__item{font-size:16px;font-family:Muli,sans-serif}.c-nav__item:not(:last-child){margin-bottom:4px}.c-nav__link{display:block;transition:.4s}.c-nav__link--current{color:#207CDF}.home-template .c-nav__link--current:not(:hover){color:#323232}.c-nav__link:hover,.c-nav__link:active,.c-nav__link:focus{color:#207CDF;text-decoration:none}.c-search{position:fixed;top:0;right:0;bottom:0;left:0;z-index:100;padding-top:doublequadruple(16px);background:#fff;transition:all .4s ease-in-out;transform:translate(0, -100%) scale(0, 0)}@media (min-width: 40em){.c-search{padding-top:64px}}.c-search.is-active{transform:translate(0, 0) scale(1, 1)}.c-search__input{padding:0;width:100%;outline:none;margin-bottom:16px;font-weight:300;font-size:28px;line-height:44px;border:0;border-bottom:1px solid #E1E0E1}@media (min-width: 40em){.c-search__input{font-size:38px;line-height:50px}}.c-search__close{position:absolute;top:16px;right:16px;cursor:pointer;fill:#323232;transition:.4s}@media (min-width: 40em){.c-search__close{top:32px;right:32px}}.c-search__close:hover{fill:#7E7E7E;transform:rotate(90deg)}.c-search-result{display:none;height:80vh;overflow:auto;white-space:normal;padding-right:32px}.c-search-result__head{padding-bottom:16px;margin-bottom:16px;color:#7E7E7E;font-family:Muli,sans-serif;border-bottom:1px solid #E1E0E1}.c-search-result__item{padding-bottom:16px;margin-bottom:16px;border-bottom:1px solid #E1E0E1;font-family:Muli,sans-serif}.c-search-result__title{display:block;line-height:25px}.c-search-result__title:hover,.c-search-result__title:active,.c-search-result__title:focus{color:#207CDF;text-decoration:none}.c-off-canvas-toggle{position:relative;z-index:10;height:19px;width:25px;cursor:pointer;display:inline-block;vertical-align:middle}.c-off-canvas-toggle__icon{position:absolute;left:0;height:1px;width:25px;background:#222228;cursor:pointer}.c-off-canvas-toggle__icon:before,.c-off-canvas-toggle__icon:after{content:'';display:block;height:100%;background-color:inherit;transition:.4s}.c-off-canvas-toggle__icon:before{transform:translateY(16px)}.c-off-canvas-toggle__icon:after{transform:translateY(7px)}.c-off-canvas-toggle--close .c-off-canvas-toggle__icon{height:2px;background-color:transparent}.c-off-canvas-toggle--close .c-off-canvas-toggle__icon:before,.c-off-canvas-toggle--close .c-off-canvas-toggle__icon:after{position:relative;visibility:visible;background:#222228}.c-off-canvas-toggle--close .c-off-canvas-toggle__icon:before{top:11px;transform:rotate(-45deg)}.c-off-canvas-toggle--close .c-off-canvas-toggle__icon:after{top:9px;transform:rotate(45deg)}.c-off-canvas-toggle--close{margin-bottom:16px}html,body{overflow-x:hidden}.c-off-canvas-content{position:fixed;top:0;left:0;z-index:10;width:300px;height:100%;padding:24px 32px;transform:translate3d(-300px, 0, 0)}@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none){.c-off-canvas-content{background-color:#fff}.c-off-canvas-content.is-active{left:300px}}.c-off-canvas-container{-webkit-perspective:1000;transition:transform .4s cubic-bezier(0.16, 0.68, 0.43, 0.99)}.c-off-canvas-container.is-active{transform:translate3d(300px, 0, 0)}.c-off-canvas-container.is-active:after{position:fixed;top:0;right:0;bottom:0;left:0;content:'';background-color:rgba(0,0,0,0.5)}.c-blog-desc{padding-top:16px;margin-top:16px;border-top:1px solid #E1E0E1;color:#7E7E7E;font-size:14px;font-family:Muli,sans-serif;line-height:22px;word-wrap:break-word}.c-tag{text-align:center;padding-bottom:32px;margin-bottom:32px;border-bottom:1px solid #E1E0E1}.c-tag__name{margin-bottom:0;font-size:28px;line-height:50px}.c-tags a{display:inline-block;padding:4px 16px;margin:0 8px 4px 0;font-size:12px;font-family:Muli,sans-serif;line-height:22px;background-color:#FAFAFA;transition:.4s}.c-tags a:hover,.c-tags a:active,.c-tags a:focus{text-decoration:none;background-color:#ECF0F1}@media (max-width: 39.99em){.c-tags{margin-bottom:22px}}.c-btn{display:inline-block;padding:8px 32px;cursor:pointer;transition:.4s;text-align:center;vertical-align:middle;white-space:nowrap;line-height:inherit;border:0;border-radius:0;color:#fff;background-color:#207cdf;font-size:16px;font-family:Muli,sans-serif}.c-btn:hover,.c-btn:active,.c-btn:focus{text-decoration:none;background-color:#238cf6}.c-btn--full{width:100%}.c-btn--small{padding:4px 16px}.c-subscribe{display:flex;flex-wrap:wrap}.c-subscribe .form-group{flex:8}.c-subscribe__btn{position:relative;left:-1px;flex:2}.c-post-card{overflow:hidden;transform:translateX(0);margin-bottom:32px;background-color:#ECF0F1;border-bottom:1px solid #E1E0E1}.c-post-card__image-link{display:block;position:relative}.c-post-card__image-link:after{position:absolute;top:0;height:100%;width:100%;content:'';background-color:#222228;transition:.4s;opacity:0}@media (min-width: 40em){.c-post-card__image{opacity:0;transition:opacity .4s ease-in-out}.c-post-card__image.is-inview{opacity:1}}@media screen and (min-width: 40em) and (-webkit-min-device-pixel-ratio: 0){.c-post-card__image{opacity:1}}.c-post-card__info{display:block;padding:16px 0;text-decoration:none;background-color:#fff}.c-post-card__info--no-image{padding-top:0}.c-post-card__info:hover{text-decoration:none;color:#323232}.c-post-card__title{margin-bottom:10px;font-size:19px;font-weight:400;line-height:25px;font-family:"Libre Baskerville",serif;transition:.4s}.c-post-card__date{display:block;margin-bottom:8px;font-size:12px;font-family:Muli,sans-serif;line-height:22px;text-transform:uppercase;color:#7E7E7E}.c-post-card:hover .c-post-card__image-link:after{opacity:.1}.c-post-card:hover .c-post-card__title{color:#207CDF}.c-post-card__excerpt{margin-bottom:10px;font-family:Muli,sans-serif}.c-post-card__featured-icon{position:absolute;bottom:8px;left:8px;fill:#fff}.c-pagination{text-transform:uppercase;transition:.4s}.c-pagination:hover,.c-pagination:active,.c-pagination:focus{color:#207CDF;text-decoration:none}.c-pagination__text{position:relative;font-size:14px;font-family:Muli,sans-serif;letter-spacing:2px}.c-pagination__text--prev{left:-16px}.c-pagination__text--next{right:-16px}.c-pagination__icon{vertical-align:text-top}.c-pagination__icon--prev{left:-8px}.c-pagination__icon--next{right:-8px}.c-post{margin:0 auto;max-width:700px}.c-post__title{font-size:24px}@media (min-width: 40em){.c-post__title{font-size:28px;line-height:50px}}.c-post__date{display:block;text-align:center;margin-bottom:16px;font-size:12px;font-family:Muli,sans-serif;line-height:22px;color:#7E7E7E}.c-post__image{margin:0 auto 16px}.c-share{display:flex;border-radius:3px;border:1px solid #E1E0E1;line-height:22px}.c-share__item{flex:1;text-align:center;border-right:1px solid #E1E0E1}.c-share__item:last-child{border-right:0}.c-share__link{display:block;padding:4px;transition:.4s}.c-share__link:hover{background-color:#FAFAFA}.c-share__link:hover .c-share__icon--twitter{fill:#55ACEE}.c-share__link:hover .c-share__icon--facebook{fill:#3B5998}.c-share__icon{fill:#7E7E7E;vertical-align:middle}.c-content a:not(.c-btn){text-shadow:0.04545em 0 0 #fff,0.09091em 0 0 #fff,0.13636em 0 0 #fff,-0.04545em 0 0 #fff,-0.09091em 0 0 #fff,-0.13636em 0 0 #fff,0 0.04545em 0 #fff,0 0.09091em 0 #fff,0 -0.04545em 0 #fff,0 -0.09091em 0 #fff;text-decoration:none;background-size:1px 1px;background-position:0 98%;background-repeat:repeat-x;background-image:linear-gradient(to bottom, #323232, #323232)}.c-author{padding-bottom:32px;margin-bottom:32px;border-bottom:1px solid #E1E0E1}@media (min-width: 64em){.c-author{display:flex;align-items:center}}.c-author__img{float:left;border-radius:100%;margin-right:16px;height:64px;width:64px}@media (min-width: 64em){.c-author__img{margin-right:32px;height:128px;width:128px}}@media (min-width: 40em){.c-author__body{overflow:hidden}}.c-author__name{margin-bottom:8px;font-family:Muli,sans-serif}.c-author__bio{margin-bottom:8px;font-size:16px;font-family:Muli,sans-serif;line-height:25px}.c-author-links{font-family:Muli,sans-serif}.c-author-links__item{display:inline-block;font-size:16px;line-height:25px}.c-author-links__icon{vertical-align:middle;fill:#323232;transition:.4s}.c-author-links__icon:hover,.c-author-links__icon:active,.c-author-links__icon:focus{fill:#207CDF}.twitter-tweet,.fluid-width-video-wrapper{margin-bottom:16px !important}.c-social-nav__item{display:inline-block}.c-social-nav__icon{fill:#323232;vertical-align:middle;transition:.4s}.c-social-nav__icon:hover,.c-social-nav__icon:active,.c-social-nav__icon:focus{fill:#207CDF}.c-footer{padding:32px 0;background-color:#FAFAFA}.u-hidden{display:none}.u-hidden-visually{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.u-font-serif{font-family:"Libre Baskerville",serif}.u-font-sans-serif{font-family:Muli,sans-serif}.u-font-medium{font-size:16px;line-height:25px}.u-font-small{font-size:14px;line-height:22px}.u-font-tiny{font-size:12px;line-height:19px}.u-text-left{text-align:left}.u-text-right{text-align:right}.u-text-center{text-align:center}.u-text-justify{text-align:justify}.u-inline{display:inline}.u-block{display:block}.u-inline-block{display:inline-block}.u-left{float:left}.u-right{float:right}.u-clearfix:after{content:'';display:table;clear:both}

  </style>

  <script>
    var base_url = "";
  </script>
</head>

<body>

  <!-- Google Analytics Code -->

  <div class='js-off-canvas-container c-off-canvas-container'>
    <header class='c-header'>

  <div class='o-grid'>
    <div class='o-grid__col o-grid__col--full'>
      <div class='c-header__inner'>

        <div class='o-grid'>
          <div class='o-grid__col o-grid__col--1-4-s'>
            <label class='js-off-canvas-toggle c-off-canvas-toggle' aria-label='Toggle navigation'>
              <span class='c-off-canvas-toggle__icon'></span>
            </label>
          </div>

          <div class='o-grid__col o-grid__col--2-4-s'>
            <div class='c-logo u-text-center'>
              
                <a href='/'>
                  <img class='c-logo__img' src='https://github.com/joergre/fachinformatiker-forum/blob/gh-pages/logo.jpg?raw=true# Logo image URL' alt='Fachinformatiker-Forum Fulda'>
                </a>
              
            </div>
          </div>

          <div class='o-grid__col o-grid__col--1-4-s'>
            <div class='u-text-right'>
              <a class='toggle-search-button js-search-toggle' href='#'>
                <span class='c-header__icon' data-icon='ei-search' data-size='s'></span>
              </a>
            </div>
            <div class='c-off-canvas-content js-off-canvas-content'>
              <label class='js-off-canvas-toggle c-off-canvas-toggle c-off-canvas-toggle--close'>
                <span class='c-off-canvas-toggle__icon'></span>
              </label>

              <ul class='c-nav o-plain-list '>
                
  
    
  

  

  
    
      <li class='c-nav__item' role='presentation'>
        <a class='c-nav__link' href='/LF10.html'>LF10 Projekt</a>
      </li>
    
  

  
    
      <li class='c-nav__item' role='presentation'>
        <a class='c-nav__link' href='/LF6_1.1_Python.html'>LF6 1.1 Python</a>
      </li>
    
  

  
    
      <li class='c-nav__item' role='presentation'>
        <a class='c-nav__link' href='/LF6_2.1_Python.html'>LF6 2.1 Python</a>
      </li>
    
  

  
    
      <li class='c-nav__item' role='presentation'>
        <a class='c-nav__link' href='/LF6_SQL.html'>LF6 SQL</a>
      </li>
    
  

  
    
      <li class='c-nav__item' role='presentation'>
        <a class='c-nav__link' href='/LF7_Einfuehrung.html'>LF7 Einführung</a>
      </li>
    
  

  
    
      <li class='c-nav__item' role='presentation'>
        <a class='c-nav__link' href='/LF7_Powershell.html'>Powershell</a>
      </li>
    
  

  
    
      <li class='c-nav__item' role='presentation'>
        <a class='c-nav__link' href='/about/'>About</a>
      </li>
    
  

  
    
      <li class='c-nav__item' role='presentation'>
        <a class='c-nav__link' href='/docker.html'>LF7 Docker</a>
      </li>
    
  

  
    
  

  
    
      <li class='c-nav__item' role='presentation'>
        <a class='c-nav__link' href='/impressum.html'>Impressum</a>
      </li>
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

              </ul>

              
                <p class='c-blog-desc'>Alles über IT.</p>
              
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

</header>

<div class='c-search js-search'>

  <div class='o-grid'>
    <div class='o-grid__col o-grid__col--4-4-s o-grid__col--3-4-m o-grid__col--2-4-l o-grid__col--center'>
      <form>
        <input type='search' class='c-search__input js-search-input' placeholder='Start typing to search'>
      </form>
    </div>
  </div>

  <div class='o-grid'>
    <div class='o-grid__col o-grid__col--4-4-s o-grid__col--3-4-m o-grid__col--2-4-l o-grid__col--center'>
      <div class='c-search-result js-search-result'></div>
    </div>
  </div>

  <div data-icon='ei-close' data-size='s' class='c-search__close js-search-close'></div>
</div>

    <div class='o-wrapper'>

  <div class='o-grid'>
    <div class='o-grid__col o-grid__col--3-4-m o-grid__col--center'>
      <article class='c-post'>
        <h1 class='c-post__title u-text-center'>Powershell</h1>

        <div class='c-content'>
          
          <h1 id="powershell-installieren">Powershell installieren</h1>

<p>Zum installieren von Powershell auf Deinem System besuche <a href="https://github.com/PowerShell/PowerShell">https://github.com/PowerShell/PowerShell</a> und folge der Anweisung.</p>

<p><strong>Beachte</strong> bitte folgende Datei: <a href="https://github.com/PowerShell/PowerShell/blob/master/docs/KNOWNISSUES.md">https://github.com/PowerShell/PowerShell/blob/master/docs/KNOWNISSUES.md</a>!</p>

<h1 id="warum-powershell">Warum Powershell</h1>

<p>Powershell ist mit der Version 6 OpenSource Software geworden und unterstützt zahlreiche Plattformen wie Windows, iOS und alle gängige Linu-Plattformen (redhat, centos, Debian, Ubuntu etc.) und auch ARM-Prozessoren und Cloud-Anbieter wie Amazon, google und Azure von Microsoft. Der Vorteil liegt jetzt darin, dass man sich nicht mehr in einer hetrogenen Systemlanschaft auf jedes System einstellen muss, sondern alle Standardaufgaben in der gleichen Umgebung ausführen kann. Ebenfalls funktionieren geschriebene Skripte von einem Windowssystem auch auf allen anderen Systemen (wenn die Abhängigkeiten erfüllt sind).</p>

<h1 id="starten-der-powershell">Starten der Powershell</h1>

<p>Mit dem Befehl</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwsh
</code></pre></div></div>

<p>wird die Powershell gestartet. Mit dem Befehl</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exit</span>
</code></pre></div></div>

<p>verlässt man die Powershell wieder.</p>

<p>Eine Übersicht der verfügbaren Befehle auf dem vorhandenen System bekommt man mit</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>get-command
</code></pre></div></div>

<p>Beim ausführen unter Ubuntu und Windows sieht man recht klar, welche Plattform am besten unterstützt wird.</p>

<h1 id="beispiel">Beispiel</h1>

<p>Um den Inhalt eines Directory anzuzeigen, verwendet Powershell den Befehl</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>get-childitem
</code></pre></div></div>

<p>Powershell versucht nun die verschiedenen Befehle der unterschiedlichen Plattformen zu vereinheitlichen. Bei Windows gibt es den Befehl</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">dir</span>
</code></pre></div></div>

<p>und bei Linux hingegen</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span>
</code></pre></div></div>

<p>Beide Befehle funktionieren auch auf allen Plattformen unter der Powershell. Aber der eigentliche Befehl heißt</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>get-childitem
</code></pre></div></div>

<h1 id="hilfe">Hilfe</h1>

<p>Die Powershell hat ein eingebautes Hilfesystem. Wenn wir uns beispielsweise alle Befehle anschauen möchten, die etwas mit den Prozessen auf unserem System zu tun haben:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> Get-Help <span class="k">*</span>process<span class="k">*</span>
                                                                                Name                              Category  Module                    Synopsis  <span class="nt">----</span>                              <span class="nt">--------</span>  <span class="nt">------</span>                    <span class="nt">--------</span>  Debug-Process                     Cmdlet    Microsoft.PowerShell.M... ...       Get-Process                       Cmdlet    Microsoft.PowerShell.M... ...       Start-Process                     Cmdlet    Microsoft.PowerShell.M... ...       Stop-Process                      Cmdlet    Microsoft.PowerShell.M... ...       Wait-Process                      Cmdlet    Microsoft.PowerShell.M... ...       Get-PSMetaConfigurationProcessed  Function  PSDesiredStateConfigur... ...       Set-PSMetaConfigDocInsProcesse... Function  PSDesiredStateConfigur... ... 
</code></pre></div></div>

<p>Wir suchen uns den Befehl Get-Process aus und möchten zu diesem Befehl mehr Informationen:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> get-help get-process                                                                                                                                  NAME                                                                                Get-Process                                                                 
SYNTAX
    Get-Process <span class="o">[[</span><span class="nt">-Name</span><span class="o">]</span> &lt;string[]&gt;] <span class="o">[</span><span class="nt">-Module</span><span class="o">]</span> <span class="o">[</span><span class="nt">-FileVersionInfo</span><span class="o">]</span>
    <span class="o">[</span>&lt;CommonParameters&gt;]

    Get-Process <span class="o">[[</span><span class="nt">-Name</span><span class="o">]</span> &lt;string[]&gt;] <span class="nt">-IncludeUserName</span>  <span class="o">[</span>&lt;CommonParameters&gt;]
</code></pre></div></div>

<p>Am Ende steht eventuell folgender Hinweis:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>REMARKS
    Get-Help cannot find the Help files <span class="k">for </span>this cmdlet on this computer. It
    is displaying only partial help.
        <span class="nt">--</span> To download and <span class="nb">install </span>Help files <span class="k">for </span>the module that includes
    this cmdlet, use Update-Help.
        <span class="nt">--</span> To view the Help topic <span class="k">for </span>this cmdlet online, <span class="nb">type</span>: <span class="s2">"Get-Help
    Get-Process -Online"</span> or
           go to https://go.microsoft.com/fwlink/?LinkID<span class="o">=</span>113324.

</code></pre></div></div>

<p>Dort ist einmal der Hinweis, dass die Hilfe nicht komplett auf unserem System installiert ist und wir dies mit dem Befehl</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>update-help <span class="nt">-force</span>
</code></pre></div></div>

<p>tun können. Jetzt wird die Hilfe wesentlich ausführlicher. Des weiteren können wir den Link öffnen der unten angegeben ist und die Hilfe online lesen. Auf einem graphischen System könnten wir eingeben:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>get-help get-process <span class="nt">-online</span>
</code></pre></div></div>

<p>Die Hilfe ist noch umfangreicher als die installierte Hilfe.</p>

<h1 id="die-4-arten-von-befehlen">Die 4 Arten von Befehlen</h1>

<p>Es gibt 4 Arten von Befehlen bei der Powershell:</p>

<p>1.) Administrative Befehle des Betriebssystems (ifconfig, ipconfig)</p>

<p>2.) Aliases wie dir und ls</p>

<p>3.) Skripte</p>

<p>4.) Cmdlets</p>

<h2 id="alias">Alias</h2>

<p>Alias sind Verweise oder Verlinkungen auf andere Befehle. Beispielsweise verweise ls und dir auf den Befehl Get-ChildItem. Eine Liste aller Aliases kann angezeigt werden mit:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Alias
</code></pre></div></div>
<p>Wir bekommen eine Liste aller Alliases und das Ziel des Verweises angezeigt. Bitte beachte, dass bei Scripten auf Aliases verzichtet werden sollte, weil die Fehlersuche durch diese sehr erschwert wird.</p>

<h2 id="cmdlets">Cmdlets</h2>

<p>Aussprache: Command Lets</p>

<p>Cmdlets sind eine neue Kategorie von Befehlen die es so bisher weder unter Windows noch Unix gab.  Sie sind daran zu erkennen, dass erst ein Verb kommt und dann ein Nomen. Wir schauen uns ein CMDlet an:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>get-command
</code></pre></div></div>

<p>Wir bekommen eine Liste aller verfügbaren CMDlets in der Powershell angezeigt.</p>

<p>Cmdlets können von anderen Quellen installiert oder selbst programmiert werden. Sogenannte Snapins können sehr viele Cmdlets beinhalten (teilweise tausende). Verfügbar sind Snapins z.B. für VirtualBox, AWS, Azure etc.</p>

<p>Wir haben oben das Cmdlet Get-Process kennengelernt. Cmdlets können Parameter mit “-“ angehängt werden, erfordern aber niemal zwingend einen Parameter. Wir möchten z.B. nur die Prozessinformationen über die offenen Shells wissen:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process <span class="nt">-name</span> bash
</code></pre></div></div>

<p>Probiere den Befehl auch mit “Bash” aus. Ist die Powershell Casesensitive? Beachtet die Linux-Konsole Groß- und Kleinschreibung?</p>

<h1 id="verketten-von-befehlen">Verketten von Befehlen</h1>

<p>Wir haben gesehen, dass wir mit</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process <span class="nt">-name</span> bash
</code></pre></div></div>

<p>die aktiven Konsolen angezeigt bekommen. Jetzt möchten wie diese beenden:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process <span class="nt">-name</span> bash | Stop-Process
</code></pre></div></div>

<p>Unsere Sitzung wird beendet, weil wir den Prozess beendet haben. Das Zeichen</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>|
</code></pre></div></div>

<p>nennt man “pipe” und bedeutet Röhre. Die Ausgabe vom ersten Befehl wird wie in einer Röhre nicht auf dem Bildschirm angezeigt sondern an dem nachfolgeneden Befehl weitergeleitet. Der Unterschied zur Linuxkonsole ist, dass dies ein Objekt ist nicht die einfache Textausgabe. Dies erhöht die Flexibilität ernorm:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process  | Select-Object <span class="nt">-property</span> CPU
</code></pre></div></div>

<p>Property bedeutet Eigenschaft und zeigt in diesem Fall vom Objekt Get-Process die Eigenschaft der CPU an. Um das ganze lesbarer zu gestalten lassen wir uns den Namen ausgeben:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process  | Select-Object <span class="nt">-property</span> name, CPU
</code></pre></div></div>

<p>Wir können auch mehere Pipes hintereinander fügen. Es soll jetzt beispielsweise die Prozesse nach der CPU-Belastung sortiert werden und nur die 10 Prozesse angezeigt werden, die die CPU am meisten belasten:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Select-Object <span class="nt">-property</span> name, CPU|Sort-Object <span class="nt">-descending</span> CPU|Select-Object <span class="nt">-first</span> 10
</code></pre></div></div>

<p>Um sinnvolle Konstrukte aufzubauen, brauchen wir eine Übersicht über die Einzelheiten des Objekts:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Get-Member
</code></pre></div></div>

<h1 id="variable">Variable</h1>

<p>Wir können das Objekt auch in einer Variable speichern. Eine Variable beginnt immer mit $:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$variable</span> <span class="o">=</span> Get-Process
</code></pre></div></div>

<p>Und auf die Variable, die das gesamte Objekt beinhaltet, den obigen Befehl anwenden;</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$variable</span> | Select-Object <span class="nt">-property</span> name, CPU|Sort-Object <span class="nt">-descending</span> CPU|Select-Object <span class="nt">-first</span> 10
</code></pre></div></div>

<h1 id="module">Module</h1>

<p>Wir können auch Module bzw. SnapIns installieren, die den Befehlsvorrat der PowerShell-Installation deutlich erweitern:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Install-Package <span class="nt">-Name</span> AzureRM.NetCore
</code></pre></div></div>
<h1 id="dateien">Dateien</h1>

<p>Um eine Ausgabe in eine Datei umzuleiten:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Get-Process | Out-File <span class="nt">-FilePath</span> /home/user/process.csv
</code></pre></div></div>

<p>Bitte Pfad entsprechend anpassen. Die Ausgaber der Datei erfolgt mit:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>process.csv
</code></pre></div></div>

<p>Eine Kodierung kann mit angegeben werden, ist aber sehr umständlich:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$encoding</span> <span class="o">=</span> New-Object System.Text.utf8encoding
Get-Process | Out-File <span class="nt">-FilePath</span> /home/user/process.csv <span class="nt">-Encoding</span> <span class="nv">$encoding</span>
</code></pre></div></div>

<p>Selbstverständlich könnte man den Befehl auch in eine Zeile schreiben. Die Verwendung der Variable dient nur dazu, zu verdeutlichen, welcher Teil die Kodierung vornimmt.</p>

<h2 id="aufgabe">Aufgabe</h2>

<p>Entwickle eine Befehlszeile, die die aktuelle, lokale Netzwerkkonfiguration als .xml in eine Datei speichert (export-Clixml). Lass Dir die Datei auf dem Bildschirm erscheinen.</p>

<h1 id="erstes-script">Erstes Script</h1>

<p>Wir legen eine Datei an mit dem Namen erst.ps mit folgendem Inhalt:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>write-host <span class="s2">"FBS ist cool"</span>
</code></pre></div></div>

<p>Installoiert dafür testhalber das Programm Visual Studio Code, das eine integrierte PowerShell hat.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="o">(</span>10 <span class="nt">-gt</span> 5<span class="o">)</span>
<span class="o">{</span>
write-host <span class="s2">"Größer"</span>
<span class="o">}</span>
</code></pre></div></div>

<p>‘-gt’ steht für ‘greater then’ als ‘größer als’. Eine Erklärung der wichtigsten Vergleichsopertoren gibt es hier: <a href="https://www.windowspro.de/script/vergleichsoperatoren-powershell-eq-lt-gt-contains-match">https://www.windowspro.de/script/vergleichsoperatoren-powershell-eq-lt-gt-contains-match</a>.</p>

<p>Wir verändern den Code:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="o">(</span>3 <span class="nt">-gt</span> 5<span class="o">)</span>
<span class="o">{</span>
write-host <span class="s2">"Größer"</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Jetzt solltze keine Ausgabe erfolgen!</p>

<p>Wir ergänzen den Code:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="o">(</span>3 <span class="nt">-gt</span> 5<span class="o">)</span>
<span class="o">{</span>
    write-host <span class="s2">"Größer"</span>
<span class="o">}</span>elseif<span class="o">(</span>11 <span class="nt">-gt</span> 5<span class="o">)</span>
<span class="o">{</span>
    write-host <span class="s2">"Juhu"</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Das Skript wird wie erwartet ausgeführt. Setze jetzt Else
If in eine einzelne Zeile:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="o">(</span>3 <span class="nt">-gt</span> 5<span class="o">)</span>
<span class="o">{</span>
    write-host <span class="s2">"Größer"</span>
<span class="o">}</span>
elseif<span class="o">(</span>11 <span class="nt">-gt</span> 5<span class="o">)</span>
<span class="o">{</span>
    write-host <span class="s2">"Juhu"</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Und Du bekommst eine Fehlermeldung. **Merke: ** Else oder ElseIf darf niemals aleine in einer Zeile stehen!</p>

<h2 id="do---while">Do - While</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Do<span class="o">{</span>
  <span class="nv">$zahl</span> <span class="o">=</span> <span class="nv">$zahl</span> + 1
  write-host <span class="s2">"</span><span class="nv">$zahl</span><span class="s2"> x FBS ist cool"</span>
  <span class="o">}</span> <span class="k">while</span><span class="o">(</span><span class="nv">$zahl</span> <span class="nt">-lt</span> 10<span class="o">)</span>

</code></pre></div></div>

<h2 id="foreach">ForEach</h2>

<p>Mit ForEach kann jedes Element eines Array ausgegeben werden:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$namen</span> <span class="o">=</span> <span class="s2">"F"</span>,<span class="s2">"B"</span>,<span class="s2">"S"</span>,<span class="s2">"i"</span>
ForEach<span class="o">(</span><span class="nv">$name</span> <span class="k">in</span> <span class="nv">$namen</span><span class="o">){</span>
write-host <span class="s2">"</span><span class="nv">$name</span><span class="s2">"</span>
<span class="o">}</span>
</code></pre></div></div>

<h1 id="powershell-als-standardshell-einrichten">Powershell als Standardshell einrichten</h1>

<p>Um Powershell als Standard einzurichten, sucht man sich selbst in der Datei /etc/passwd mit rinmem beliebigen Editor:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vim /etc/passwd
</code></pre></div></div>

<p>und verändert den Eintrag /bin/bash zu (nachdem man den Pfad überprüft hat):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>user@joergreuter3:~<span class="nv">$ </span>whereis pwsh
pwsh: /usr/bin/pwsh
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/bin/pwsh
</code></pre></div></div>

<h1 id="prozesse">Prozesse</h1>

<p>Wir schauen uns nocheinmal den Befehl an um die laufende Prozesse angezeigt zu bekommen:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process
</code></pre></div></div>

<p>Eine sehr ungeordnete Ausgabe. Wir schränken die Ausgabe auf die ersten 1o Elemente ein:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process|Select-Object <span class="nt">-first</span> 10
</code></pre></div></div>

<p>Jetzt möchten wir die Prozesse absteigend nach CPU-Belastung sortieren:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process|Sort-Object <span class="nt">-Descending</span> CPU|Select-Object <span class="nt">-first</span> 10
</code></pre></div></div>

<p>Dann weißen wir das ganze einer Variable zu:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$belastung</span> <span class="o">=</span> Get-Process|Sort-Object <span class="nt">-Descending</span> CPU|Select-Object <span class="nt">-first</span> 10
</code></pre></div></div>

<p>Lassen uns die Variable anzeigen:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS /home/user&gt; <span class="nv">$belastung</span>

 NPM<span class="o">(</span>K<span class="o">)</span>    PM<span class="o">(</span>M<span class="o">)</span>      WS<span class="o">(</span>M<span class="o">)</span>     CPU<span class="o">(</span>s<span class="o">)</span>      Id  SI ProcessName
 <span class="nt">------</span>    <span class="nt">-----</span>      <span class="nt">-----</span>     <span class="nt">------</span>      <span class="nt">--</span>  <span class="nt">--</span> <span class="nt">-----------</span>
      0     0.00      17.87       4.51    1114 114 amazon-ssm-agen
      0     0.00       5.74       2.30       1   1 systemd
      0     0.00     102.17       2.00    1974 974 pwsh
      0     0.00       3.43       1.68    1098 098 iscsid
      0     0.00       6.79       0.49     380 380 systemd-journal
      0     0.00      25.59       0.39    1135 135 snapd
      0     0.00       0.14       0.35    1097 097 iscsid
      0     0.00      39.27       0.23    1147 147 node
      0     0.00       6.05       0.23    1139 139 accounts-daemon
      0     0.00       0.00       0.18       4   0 kworker/0:0
</code></pre></div></div>

<p>Jetzt möchten wir die Ausgabe als Json bekommen:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$belastung_json</span> <span class="o">=</span> Get-Process|Sort-Object <span class="nt">-Descending</span> CPU|Select-Object <span class="nt">-first</span> 10|ConvertTo-Json
</code></pre></div></div>

<p>Wir können auch die Variable direkt in Json umwandeln:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$belastung_json2</span> <span class="o">=</span> <span class="nv">$belastung</span>| ConvertTo-Json
</code></pre></div></div>

<p>Wir lassen uns von der Prozessliste nur CPU und Name ausgeben:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process|Select-Object <span class="nt">-property</span> name, cpu
</code></pre></div></div>

<p>Und jetzt Name und virtueller Speicher (VM):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process|Select-Object <span class="nt">-property</span> name, vm
</code></pre></div></div>

<p>Wir möchten jetzt die Spalte VM nicht in Byte sondern in Gigabyte dargestellt bekommen.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS /home/user&gt; 1gb
1073741824
</code></pre></div></div>

<p>Wir müssen jetzt eine neue Spalte generieren die aus der Spalte VM den Wert nimmt und durch 1 GB teilt. Damit das Ergebniss leichter zu lesen ist, wandeln wir das Ergenis in ein Integer um:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process|Select-Object <span class="nt">-property</span> name, @<span class="o">{</span>Label <span class="o">=</span><span class="s1">'MGB'</span><span class="p">;</span>Expression <span class="o">={</span><span class="nv">$_</span>.VM / 1gb <span class="nt">-as</span> <span class="o">[</span>int]<span class="o">}}</span>|Sort-Object <span class="nt">-property</span> MGB <span class="nt">-Descending</span>|Select-Object <span class="nt">-first</span> 10
</code></pre></div></div>

<p>Um die Berechnung der Spalte zu speichern, kann man folgenden Befehl verwenden:</p>

<pre><code class="language-bas">Update-TypeData -Typename System.Diagnostics.process -MemberType ScriptProperty -MemberName MGB -value {$this.VM/1gb -as [int]}
</code></pre>

<p>Wir überprüfen das:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS /home/user&gt; Get-Process|Select-Object <span class="nt">-property</span> name, MGD                    
Name            MGD
<span class="nt">----</span>            <span class="nt">---</span>
<span class="o">(</span>sd-pam<span class="o">)</span>          0
accounts-daemon   0
acpid             0
agetty            0
agetty            0
amazon-ssm-agen   0
</code></pre></div></div>

<h2 id="aufgabe-1">Aufgabe</h2>

<p>Die Ausgabe soll absteigend nach MGB sortiert werden. Weiterhin sollen nur die ersten 10 Zeilen ausgegeben werden.</p>

<h1 id="alias-1">Alias</h1>

<p>Wir setzen das Alias meinProzess:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Set-Alias meinProzess Get-Process
meinProzess
</code></pre></div></div>

<p>und rufen das Alias in der nächsten Zeile auf.</p>

<h2 id="aufgabe-2">Aufgabe</h2>

<p>Löse mit Alias folgende Aufgabe: Unter Windows soll unter dem Alias “myEditor” Notepad aufgerufen werdewn und unter Linux nano.</p>

<h2 id="alias-und-funktionen">Alias und Funktionen</h2>

<p>Wir definieren eine Funktion CDOpt und rufen diese auf:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS /home/user&gt; <span class="k">function </span>CDOpt <span class="o">{</span>set-location /opt/<span class="o">}</span>
PS /home/user&gt; CDOpt
PS /opt&gt;
</code></pre></div></div>

<p>Die Funktion bringt uns immer in ein bestimmtes Verzeichnis, egal an welchem Ort wir uns gerade befinden.</p>

<p>Wir können jetzt die Funktion mit einem Alias versehen:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS /opt&gt; Set-Alias my CDOpt
PS /opt&gt; <span class="nb">cd</span> ~
PS /home/user&gt; my
PS /opt&gt;
</code></pre></div></div>

<p>Mit dem Befehl “my” rufen wir die Funktion CDOpt auf die uns in das Verzeichnis /opt bringt.</p>

<h1 id="python-in-powershell">Python in Powershell</h1>

<p>Wir legen eine Datei an mit dem Namen fbs.py und folgendem Inhalt (vorher bitte ins Home-Verzeichnis wechseln mit dem Befehl “cd ~”):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/python</span>
<span class="k">print</span><span class="p">(</span><span class="s">"FBS ist cool!"</span><span class="p">)</span>
</code></pre></div></div>

<p>und setzen die Ausführungsechte und starten das Skript:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS /home/user&gt; <span class="nb">chmod </span>a+x fbs.py
PS /home/user&gt; ./fbs.py
FBS ist cool!
</code></pre></div></div>

<h1 id="arbeiten-mit-dateien">Arbeiten mit Dateien</h1>

<p>Wir erstellen eine json-Datei (siehe oben) mit den ersten 10 Zeilen der Prozessliste, Der Befehl funktioniert nur unter Linux da head und cat Linux-Befehle sind:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS /home/user&gt; Get-Process|head|ConvertTo-Json|out-file ausgabe.json
PS /home/user&gt; <span class="nb">cat</span> ./ausgabe.json
<span class="o">[</span>
  <span class="s2">""</span>,
  <span class="s2">" NPM(K)    PM(M)      WS(M)     CPU(s)      Id  SI ProcessName                  "</span>,
  <span class="s2">" ------    -----      -----     ------      --  -- -----------                  "</span>,
  <span class="s2">"      0     0.00       2.16       0.00    2404 401 (sd-pam)                     "</span>,
  <span class="s2">"      0     0.00       6.18       0.56    1128 128 accounts-daemon              "</span>,
  <span class="s2">"      0     0.00       1.24       0.00    1146 146 acpid                        "</span>,
  <span class="s2">"      0     0.00       2.13       0.10    1259 259 agetty                       "</span>,
  <span class="s2">"      0     0.00       1.83       0.28    1264 264 agetty                       "</span>,
  <span class="s2">"      0     0.00      19.68       5.90    1137 137 amazon-ssm-agen              "</span>,
  <span class="s2">"      0     0.00       0.00       0.00      25   0 ata_sff                      "</span>
<span class="o">]</span>

</code></pre></div></div>

<p>Wir können den Inhalt wieder in PowerShell einlesen und als Variable speichern. Den Inhalt der Variable $Daten geben wir dann aus:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS /home/user&gt; <span class="nv">$Daten</span> <span class="o">=</span> Get-Content ausgabe.json
PS /home/user&gt; <span class="nv">$Daten</span>
<span class="o">[</span>
  <span class="s2">""</span>,
  <span class="s2">" NPM(K)    PM(M)      WS(M)     CPU(s)      Id  SI ProcessName                  "</span>,
  <span class="s2">" ------    -----      -----     ------      --  -- -----------                  "</span>,
  <span class="s2">"      0     0.00       2.16       0.00    2404 401 (sd-pam)                     "</span>,
  <span class="s2">"      0     0.00       6.18       0.56    1128 128 accounts-daemon              "</span>,
  <span class="s2">"      0     0.00       1.24       0.00    1146 146 acpid                        "</span>,
  <span class="s2">"      0     0.00       2.13       0.10    1259 259 agetty                       "</span>,
  <span class="s2">"      0     0.00       1.83       0.28    1264 264 agetty                       "</span>,
  <span class="s2">"      0     0.00      19.68       5.90    1137 137 amazon-ssm-agen              "</span>,
  <span class="s2">"      0     0.00       0.00       0.00      25   0 ata_sff                      "</span>
<span class="o">]</span>

</code></pre></div></div>

<p>Wir können das Json-File auch konvertieren in die Ursprügliche Ausgabe:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS /home/user&gt; <span class="nv">$Daten</span> <span class="o">=</span> Get-Content ausgabe.json|ConvertFrom-Json
PS /home/user&gt; <span class="nv">$Daten</span>

 NPM<span class="o">(</span>K<span class="o">)</span>    PM<span class="o">(</span>M<span class="o">)</span>      WS<span class="o">(</span>M<span class="o">)</span>     CPU<span class="o">(</span>s<span class="o">)</span>      Id  SI ProcessName
 <span class="nt">------</span>    <span class="nt">-----</span>      <span class="nt">-----</span>     <span class="nt">------</span>      <span class="nt">--</span>  <span class="nt">--</span> <span class="nt">-----------</span>
      0     0.00       2.16       0.00    2404 401 <span class="o">(</span>sd-pam<span class="o">)</span>
      0     0.00       6.18       0.56    1128 128 accounts-daemon
      0     0.00       1.24       0.00    1146 146 acpid
      0     0.00       2.13       0.10    1259 259 agetty
      0     0.00       1.83       0.28    1264 264 agetty
      0     0.00      19.68       5.90    1137 137 amazon-ssm-agen
      0     0.00       0.00       0.00      25   0 ata_sff
</code></pre></div></div>

<p>Aber nicht nur das, dass gesamte Objekt steht wieder zur Verfügung!:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS /home/user&gt; <span class="nv">$Daten</span>|Sort-Object <span class="nt">-Descending</span> CPU

 NPM<span class="o">(</span>K<span class="o">)</span>    PM<span class="o">(</span>M<span class="o">)</span>      WS<span class="o">(</span>M<span class="o">)</span>     CPU<span class="o">(</span>s<span class="o">)</span>      Id  SI ProcessName
 <span class="nt">------</span>    <span class="nt">-----</span>      <span class="nt">-----</span>     <span class="nt">------</span>      <span class="nt">--</span>  <span class="nt">--</span> <span class="nt">-----------</span>
      0     0.00       2.16       0.00    2404 401 <span class="o">(</span>sd-pam<span class="o">)</span>
      0     0.00       6.18       0.56    1128 128 accounts-daemon
      0     0.00       1.24       0.00    1146 146 acpid
      0     0.00       2.13       0.10    1259 259 agetty
      0     0.00       1.83       0.28    1264 264 agetty
      0     0.00      19.68       5.90    1137 137 amazon-ssm-agen
      0     0.00       0.00       0.00      25   0 ata_sff
</code></pre></div></div>

<p>Und wir können uns alle Member des Objekts anzeigen lassen:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$Daten</span>|Get-Member
</code></pre></div></div>


        </div>
      </article>
    </div>
  </div>

</div>

    <footer class='c-footer'>
  <div class='o-grid'>
    <div class='o-grid__col o-grid__col--full'>

      <ul class='o-plain-list c-social-nav u-text-center'>
        
          <li class='c-social-nav__item'>
            <a href='http://www.twitter.com/joergreu' target='_blank'>
              <span class='c-social-nav__icon' data-icon='ei-sc-twitter' data-size='s'></span>
            </a>
          </li>
        
        
          <li class='c-social-nav__item'>
            <a href='https://instagram.com/jorgreuter' target='_blank'>
              <span class='c-social-nav__icon' data-icon='ei-sc-instagram' data-size='s'></span>
            </a>
          </li>
        
        
        <li class='c-social-nav__item'>
          <a href='http://www.github.com/joergre' target='_blank'>
            <span class='c-social-nav__icon' data-icon='ei-sc-github' data-size='s'></span>
          </a>
        </li>
        

        
        <li class='c-social-nav__item'>
          <a href='mailto:joerg@reuter.sc' target='_blank'>
            <span class='c-social-nav__icon' data-icon='ei-envelope' data-size='s'></span>
          </a>
        </li>
	
	
        <li class='c-social-nav__item'>
          <a href='https://www.youtube.com/user/fbsfulda/' target='_blank'>
            	<span class='c-social-nav__icon' data-icon='ei-sc-youtube' data-size='s'></span>
          </a>
        </li>

        
      </ul>

      <div class='u-text-center'>
        <span class='u-font-small u-font-sans-serif'>&copy; 2018 Fachinformatiker-Forum Fulda</span>
      </div>

    </div>
  </div>
</footer>
  </div>

  <script src="/js/jquery-3.1.1.min.js">            </script>
  <script src="/js/masonry.pkgd.min.js">            </script>
  <script src="/js/imagesloaded.pkgd.min.js">       </script>
  <script src="/js/jquery.viewportchecker.min.js">  </script>
  <script src="/js/jquery.ghostHunter.min.js">      </script>
  <script src="/js/evil-icons.min.js">              </script>
  <script src="/js/jquery.fitvids.js">              </script>
  <script src="/js/app.js">                         </script>
</body>

</html>